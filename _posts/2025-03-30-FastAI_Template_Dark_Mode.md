# How to Set-up Dark Mode for the fastai Blog Template and Local Ruby Development

This blog was originally created through the use of fastai's ``fast_template``. The guide followed to set-up this blog can be found at https://www.fast.ai/posts/2020-01-16-fast_template.html.

Like most people I have become accustomed to using a dark theme, and I honestly avoid using a light theme when I can to protect my eyes. Also, I personally believe a dark theme just looks more aesthetic overall. So as soon as I loaded up this GitHub Pages website with the ``fast_template``, I immediately wanted to try and hack it, to get a dark theme going. I only know the very basics of HTML and CSS, and I especially don't know anything about jekyll, Gem or Ruby, which is used by GitHub Pages and ``fast_template``. So thus began a mission to utilise ChatGPT to overcome my lack of knowledge. Here are the results of what I came up with after 30 minutes of talking with ChatGPT back and forth.

## Local Ruby Development

As I was developing my Blog/GitHub Pages within Ubuntu through WSL on my Windows computer, I learned that it was possible to locally develop my website, instead of having to commit to GitHub every time to see my changes. This was instrumental in speeding up my time trying to get a dark theme to work, and will definitely help with further development of this Blog. Thus, I thought I would share how to do it here, so that others could develop locally too. Make sure to have your GitHub Pages repository cloned into Ubuntu, so you can follow along with this code. 

### Step 1: Install Ruby + Jekyll + Bundler

```bash
sudo apt update
sudo apt install ruby-full build-essential zlib1g-dev
```

Then install Bundler and Jekyll:

```bash
gem install bundler
gem install jekyll
```

Now edit your `.bashrc` file to include the Ruby's gem path. This can be done with: 

```bash
echo '# Install Ruby Gems to ~/.gem' >> ~/.bashrc
echo 'export GEM_HOME="$HOME/.gem"' >> ~/.bashrc
echo 'export PATH="$HOME/.gem/bin:$PATH"' >> ~/.bashrc
source ~/.bashrc
```

### Step 2: Install Dependencies

Now navigate to the location where you have cloned your GitHub pages repository. Make sure to edit {GitHub Username}, with your GitHub username.

```bash
cd ~/path/to/{GitHub Username}.github.io
```

And then install the necessary bundle dependencies. 

```bash
bundle install
```

### Step 3: Run Your Site Locally

Now all you need to do is run the following code and visit http://localhost:4000 to see your blog run locally!

```bash
bundle exec jekyll serve
```

## Add Automatic Dark Theme

If you follow along with the below steps, you should be able to add an automatic dark theme to your blog that reacts based on the user's devices theme. For instance, if they have dark mode activate they will see the dark theme, and if they have a light mode active, they will see the light theme for the blog.

### Step 1: Create Custom CSS File

The first step is to create a custom CSS file to store the necessary styling information for the automatic dark theme. Under the `assets` file create a new folder named `css` and within `css` add a new file called `custom.cc`. The new file structure should look like:

```bash
assets
   └── css
        └── custom.css
```

Now within the `custom.css` file, add the following CSS code. This sets-up a modified **Tokyo Night** theme for the dark mode.

```css
@media (prefers-color-scheme: dark) {
  /* Global Dark Mode Styles
     -------------------------
     Sets overall background, text, link, and header colors,
     and applies a subtle image dimming effect.
  */
  body {
    background-color: #121212 !important;
    color: #e0e0e0 !important;
  }
  a {
    color: #90caf9 !important;
  }
  h1, h2, h3 {
    color: #ffffff !important;
  }
  img {
    filter: brightness(0.9) !important;  /* Dim images slightly */
  }
  
  /* Generic Code Block Styling (non-highlighted) - Tokyo Night Theme
     -----------------------------------------------
     Applies to basic <pre> and <code> blocks created by Markdown.
  */
  pre {
    background-color: #1e1e1e !important;
    color: #dcdcdc !important;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace !important;
    padding: 1em !important;
    border-radius: 6px !important;
    overflow-x: auto !important;
  }
  code {
    background-color: #1e1e1e !important;
    color: #dcdcdc !important;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace !important;
    padding: 0.2em 0.4em !important;
    border-radius: 4px !important;
  }
  
  /* Syntax-Highlighted Code Block Styling (Rouge) - Tokyo Night Theme
     ------------------------------------------------
     Styles code blocks generated by Rouge within a container (.highlight).
  */
  .highlight {
    background-color: #1a1b26 !important;  /* Deep navy blue background */
    border-radius: 6px !important;
    padding: 0.5em !important;
  }
  .highlight pre {
    background-color: #1a1b26 !important;
    color: #c0caf5 !important;  /* Soft blue text */
    white-space: pre-wrap !important;
    word-wrap: break-word !important;
    tab-size: 2;
    padding-left: 5px !important;  /* Added unit */
    margin: 0 !important;
  }
  .highlight code {
    background-color: transparent !important;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace !important;
    display: block !important;
    padding-left: 5px !important;  /* Added unit */
  }
  
  /* Rouge Token Styling - Tokyo Night Theme
     ---------------------
     Colors for specific syntax tokens. Adjust these to change the theme’s look.
  */
  .highlight .k { color: #bb9af7 !important; }   /* Keywords (lavender) */
  .highlight .s { color: #9ece6a !important; }   /* Strings (green) */
  .highlight .n { color: #7dcfff !important; }   /* Names/Variables (sky blue) */
  .highlight .c {
    color: #9aa5ce !important;                 /* Comments (dim blue-gray) */
    font-style: italic !important;
  }
  .highlight .o { color: #ff9e64 !important; }   /* Operators (orange) */
  .highlight .mi { color: #ff757f !important; }  /* Numbers (pinkish red) */
  .highlight .nt,
  .highlight .nc { color: #bb9af7 !important; }  /* Tag names/Selectors (lavender) */
  .highlight .na { color: #9ece6a !important; }  /* Attribute names (green) */
  
  /* Inline Code Styling for Normal Text
     -------------------------------------
     Applies to inline code elements (wrapped in backticks) within paragraphs, lists, and spans.
  */
  p code, li code, span code {
    background-color: #1f2335 !important;
    color: #c0caf5 !important;
    font-family: Consolas, Monaco, monospace !important;
    font-size: 0.95em !important;
    padding: 0.2em 0.4em !important;
    border-radius: 4px !important;
    white-space: nowrap !important;
  }
  
  /* Inline Code Styling for Headers
     ---------------------------------
     Reduces the font size so inline code inside header tags doesn’t appear oversized.
  */
  h1 code, h2 code, h3 code, h4 code, h5 code, h6 code {
    background-color: #1f2335 !important;
    color: #c0caf5 !important;
    font-family: Consolas, Monaco, monospace !important;
    font-size: 0.7em !important;
    padding: 0.15em 0.35em !important;
    border-radius: 4px !important;
    vertical-align: middle !important;
  }
}

```

### Step 2: Modify `_includes/head.html`:

Now go to the folder `_includes` and open the file called `head.html`. Then add the following line of code to link the custom css file you made, `custom.css`. 

```html
<link rel="stylesheet" href="/assets/css/custom.css">
```

### Step 3: Run Locally To Test:

Now if you have completed the guide [Local Ruby Development](#local-ruby-development), you can test your websites dark theme via the following command in the Ubuntu terminal.

```bash
bundle exec jekyll serve
```

If you can't see the dark theme, ensure your system/browser has dark mode enabled.